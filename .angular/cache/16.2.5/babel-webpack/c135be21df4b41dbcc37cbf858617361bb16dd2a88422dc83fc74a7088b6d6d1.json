{"ast":null,"code":"import _asyncToGenerator from \"C:/dev/Ionic/purasangre-app-v2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate, __metadata } from \"tslib\";\n// env\nimport { environment } from '../../../environments/environment';\nimport { Router } from '@angular/router';\nimport { Component } from '@angular/core';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Preferences } from '@capacitor/preferences';\nimport { Platform, ToastController } from '@ionic/angular';\n// import { ClasesService } from './clases.service';\nlet ClasesPage = class ClasesPage {\n  constructor(plt,\n  // private storage: Storage,\n  router, http, toastController) {\n    this.plt = plt;\n    this.router = router;\n    this.http = http;\n    this.toastController = toastController;\n    this.todayWods = [];\n    this.clases = [];\n    this.alerts = [];\n    this.pendient = [];\n    this.confirmed = [];\n    this.page = 1;\n    this.buttonFixIOS = '';\n    this.buttonFixAndroid = '';\n    this.confirmation = '';\n    if (this.plt.is('ios')) {\n      // Si es iOS\n      this.buttonFixIOS = 'button-fix-ios';\n      this.buttonFixAndroid = 'display-none';\n    } else {\n      // Si es Android\n      this.buttonFixIOS = 'display-none';\n      this.buttonFixAndroid = 'button-fix';\n    }\n    // var buttonConf = document.getElementById('confirmacion');\n  }\n  // Refresh\n  doRefresh(event) {\n    console.log('Begin async operation');\n    this.ionViewDidEnter();\n    setTimeout(() => {\n      console.log('Async operation has ended');\n      event.target.complete();\n    }, 2000);\n  }\n  presentToast() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const toast = yield _this.toastController.create({\n        message: 'Hora Reservada',\n        duration: 2500,\n        position: 'top'\n      });\n      toast.present();\n    })();\n  }\n  ionViewDidEnter() {\n    console.log('estoy cargandome........');\n    Preferences.get({\n      key: 'authData'\n    }).then(authData => {\n      const parsedData = JSON.parse(authData.value);\n      this.httpOptions = {\n        headers: new HttpHeaders({\n          Authorization: `Bearer ${parsedData.token}` // updated\n        })\n      };\n\n      this.http.get(`${environment.SERVER_URL}/clases-coming?sort_by_asc=date`, this.httpOptions).subscribe(result => {\n        this.pendient = result.data.filter(clase => clase.rels.auth_reservation.status === 'Pendiente');\n        this.confirmed = result.data.filter(clase => clase.rels.auth_reservation.status === 'Confirmada');\n      }, err => {\n        console.log('error clases');\n        // this.authService.refreshToken();\n      });\n\n      this.http.get(`${environment.SERVER_URL}/clases-historic?sort_by_desc=date&page=${this.page}`, this.httpOptions).subscribe(result => {\n        this.clases = result.data.filter(clase => clase.rels.auth_reservation.status === 'Consumida');\n      });\n      this.http.get(`${environment.SERVER_URL}/users-alerts`, this.httpOptions).subscribe(result => {\n        this.alerts = result.data;\n      });\n      this.http.get(`${environment.SERVER_URL}/todaywods`, this.httpOptions).subscribe(result => {\n        this.todayWods = result.data;\n      });\n    });\n  }\n  goToSelectClaseType() {\n    console.log('entre a la clase type');\n    this.router.navigate(['/home/tabs/clases/clase-type']);\n  }\n  goTo(wod) {\n    const reservation = wod.rels.auth.todayReservation;\n    console.log('entre goto');\n    console.log(reservation);\n    if (wod.rels.auth.reservationHas) {\n      console.log('tengo clase');\n      if (reservation.status === 1 || reservation.status === 2) {\n        this.router.navigate(['/home/edit-confirm/' + reservation.id]);\n      }\n      if (reservation.status === 3) {\n        this.router.navigate(['/home/clase/' + reservation.id]);\n      }\n      if (reservation.status === 4) {\n        this.router.navigate(['/home/wods/' + wod.identificador]);\n      }\n    } else {\n      console.log('no tengo clase');\n      this.router.navigate(['/home/wods/' + wod.identificador]);\n    }\n  }\n  goClase(id) {\n    this.router.navigate(['/home/tabs/clases/' + id + '/show']);\n  }\n  loadMoreClases(infiniteScrollEvent) {\n    this.http.get(`${environment.SERVER_URL}/clases-historic?sort_by_desc=date&page=${this.page}`, this.httpOptions).subscribe(result => {\n      console.log('mas clases');\n      console.log('page:' + this.page);\n      this.clases = this.clases.concat(result.data.filter(clase => clase.rels.auth_reservation.status === 'Consumida'));\n      this.page++;\n      infiniteScrollEvent.target.complete();\n    }, err => {\n      console.log('error clases');\n    });\n  }\n  enter() {\n    console.log('entreeeeeeeee!!!!!!!!!!!!!!!');\n  }\n};\nClasesPage = __decorate([Component({\n  selector: 'app-clases',\n  templateUrl: './clases.page.html',\n  styleUrls: ['./clases.page.scss']\n}), __metadata(\"design:paramtypes\", [Platform, Router, HttpClient, ToastController])], ClasesPage);\nexport { ClasesPage };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}